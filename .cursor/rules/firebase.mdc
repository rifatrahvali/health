---
description: Firebase ve backend iÅŸlemleri kurallarÄ±
---

# Firebase ve Backend KurallarÄ±

[CLAUDE.md](mdc:CLAUDE.md) dokÃ¼manÄ±na gÃ¶re Firebase kullanÄ±m kurallarÄ±:

## ğŸ”¥ Firebase Servisleri
- **Authentication**: KullanÄ±cÄ± yÃ¶netimi iÃ§in Firebase Auth
- **Database**: Real-time veri iÃ§in Firestore  
- **Storage**: Resim/dosyalar iÃ§in Firebase Storage
- **Analytics**: KullanÄ±cÄ± takibi iÃ§in Firebase Analytics
- **Crashlytics**: Hata raporlama iÃ§in
- **Cloud Functions**: Server-side mantÄ±k iÃ§in

## ğŸ“Š Firestore YapÄ±sÄ±
```typescript
// Koleksiyon yapÄ±sÄ±
users/{userId}/
  profile: { ... }
  onboarding: { ... }
  settings: { ... }

symptoms/{userId}/
  entries/{entryId}: { ... }

meals/{userId}/  
  entries/{entryId}: { ... }

insights/{userId}/
  daily/
  weekly/
  monthly/
```

## ğŸ”’ GÃ¼venlik KurallarÄ±
- KullanÄ±cÄ± sadece kendi verilerini okuyabilir/yazabilir
- Veri tiplerini ve zorunlu alanlarÄ± doÄŸrula
- Yazma iÅŸlemleri iÃ§in rate limiting

## ğŸ’¾ API ve Veri KurallarÄ±

### âœ… YAPILACAKLAR
```typescript
// Async/await kullan
const fetchUserData = async (userId: string) => {
  try {
    const doc = await firestore()
      .collection('users')
      .doc(userId)
      .get();
    return doc.data();
  } catch (error) {
    console.error('KullanÄ±cÄ± verisi alÄ±namadÄ±:', error);
    throw error;
  }
};

// Loading state gÃ¶ster
const [loading, setLoading] = useState(false);

// Optimistic updates
const updateSymptom = async (data) => {
  // UI'Ä± hemen gÃ¼ncelle
  setSymptoms(prev => [...prev, data]);
  
  // Sonra Firebase'e gÃ¶nder
  try {
    await firestore().collection('symptoms').add(data);
  } catch (error) {
    // Hata durumunda geri al
    setSymptoms(prev => prev.filter(item => item.id !== data.id));
  }
};
```

### âŒ YAPILMAYACAKLAR
- Promise zinciri kullanma (async/await kullan)
- Error handling atlamak  
- Loading state gÃ¶stermemek
- PII bilgileri loglarda tutmak
- HTTP yerine HTTPS kullanmak

## ğŸ”„ Offline DesteÄŸi
```typescript
// Firestore offline persistence
firestore().enablePersistence();

// Offline durumu kontrol et
const isOnline = useNetInfo();
```

## ğŸš¨ Hata YÃ¶netimi
- Her async iÅŸlem iÃ§in try/catch
- Error boundary'ler feature'lar iÃ§in  
- KullanÄ±cÄ± dostu hata mesajlarÄ±
- Crash reporting iÃ§in Crashlytics

## ğŸ“± Performance
- Lazy loading ekran bileÅŸenleri iÃ§in
- Debounce kullanÄ±cÄ± girdileri iÃ§in (arama vb.)
- FlatList bÃ¼yÃ¼k listeler iÃ§in optimizasyon
- Image optimizasyonu uygun boyut/format